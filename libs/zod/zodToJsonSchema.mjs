/* esm.sh - esbuild bundle(zod-to-json-schema@3.22.4) es2022 production */
function x(e,t,r,n){n?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function u(e,t,r,n,a){e[t]=r,x(e,t,n,a)}var b={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"string",mapStrategy:"entries",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",emailStrategy:"format:email"},v=e=>typeof e=="string"?{...b,name:e}:{...b,...e};import{ZodFirstPartyTypeKind as s}from"./zod.mjs";function D(){return{}}import{ZodFirstPartyTypeKind as ee}from"./zod.mjs";function _(e,t){let r={type:"array"};return e.type?._def?.typeName!==ee.ZodAny&&(r.items=i(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&u(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&u(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(u(r,"minItems",e.exactLength.value,e.exactLength.message,t),u(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}function k(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"min":t.target==="jsonSchema7"?n.inclusive?u(r,"minimum",n.value,n.message,t):u(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),u(r,"minimum",n.value,n.message,t));break;case"max":t.target==="jsonSchema7"?n.inclusive?u(r,"maximum",n.value,n.message,t):u(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),u(r,"maximum",n.value,n.message,t));break;case"multipleOf":u(r,"multipleOf",n.value,n.message,t);break}return r}function Z(){return{type:"boolean"}}function O(e,t){return i(e.type._def,t)}var S=(e,t)=>i(e.innerType._def,t);function j(e,t){return t.dateStrategy=="integer"?te(e,t):{type:"string",format:"date-time"}}var te=(e,t)=>{let r={type:"integer",format:"unix-time"};for(let n of e.checks)switch(n.kind){case"min":t.target==="jsonSchema7"&&u(r,"minimum",n.value,n.message,t);break;case"max":t.target==="jsonSchema7"&&u(r,"maximum",n.value,n.message,t);break}return r};function M(e,t){return{...i(e.innerType._def,t),default:e.defaultValue()}}function A(e,t){return t.effectStrategy==="input"?i(e.schema._def,t):{}}function T(e){return{type:"string",enum:e.values}}var re=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function N(e,t){let r=[i(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),i(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(o=>!!o),n=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,a=[];return r.forEach(o=>{if(re(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(n=void 0);else{let p=o;if("additionalProperties"in o&&o.additionalProperties===!1){let{additionalProperties:c,...g}=o;p=g}else n=void 0;a.push(p)}}),a.length?{allOf:a,...n}:void 0}function L(e,t){let r=typeof e.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[e.value]}:{type:r==="bigint"?"integer":r,const:e.value}}import{ZodFirstPartyTypeKind as P}from"./zod.mjs";var f={cuid:"^[cC][^\\s-]{8,}$",cuid2:"^[a-z][a-z0-9]*$",ulid:"^[0-9A-HJKMNP-TV-Z]{26}$",email:"^(?!\\.)(?!.*\\.\\.)([a-zA-Z0-9_+-\\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\\-]*\\.)+[a-zA-Z]{2,}$",emoji:"^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",uuid:"^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$",ipv4:"^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$",ipv6:"^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$"};function y(e,t){let r={type:"string"};function n(a){return t.patternStrategy==="escape"?ne(a):a}if(e.checks)for(let a of e.checks)switch(a.kind){case"min":u(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,t);break;case"max":u(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":l(r,"email",a.message,t);break;case"format:idn-email":l(r,"idn-email",a.message,t);break;case"pattern:zod":m(r,f.email,a.message,t);break}break;case"url":l(r,"uri",a.message,t);break;case"uuid":l(r,"uuid",a.message,t);break;case"regex":m(r,a.regex.source,a.message,t);break;case"cuid":m(r,f.cuid,a.message,t);break;case"cuid2":m(r,f.cuid2,a.message,t);break;case"startsWith":m(r,"^"+n(a.value),a.message,t);break;case"endsWith":m(r,n(a.value)+"$",a.message,t);break;case"datetime":l(r,"date-time",a.message,t);break;case"length":u(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,t),u(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"includes":{m(r,n(a.value),a.message,t);break}case"ip":{a.version!=="v6"&&l(r,"ipv4",a.message,t),a.version!=="v4"&&l(r,"ipv6",a.message,t);break}case"emoji":m(r,f.emoji,a.message,t);break;case"ulid":{m(r,f.ulid,a.message,t);break}case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}var ne=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),l=(e,t,r,n)=>{e.format||e.anyOf?.some(a=>a.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):u(e,"format",t,r,n)},m=(e,t,r,n)=>{e.pattern||e.allOf?.some(a=>a.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:t,...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):u(e,"pattern",t,r,n)};function h(e,t){if(t.target==="openApi3"&&e.keyType?._def.typeName===P.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((n,a)=>({...n,[a]:i(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",a]})??{}}),{}),additionalProperties:!1};let r={type:"object",additionalProperties:i(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if(t.target==="openApi3")return r;if(e.keyType?._def.typeName===P.ZodString&&e.keyType._def.checks?.length){let n=Object.entries(y(e.keyType._def,t)).reduce((a,[o,p])=>o==="type"?a:{...a,[o]:p},{});return{...r,propertyNames:n}}else if(e.keyType?._def.typeName===P.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};return r}function $(e,t){if(t.mapStrategy==="record")return h(e,t);let r=i(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},n=i(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function E(e){let t=e.values,n=Object.keys(e.values).filter(o=>typeof t[t[o]]!="number").map(o=>t[o]),a=Array.from(new Set(n.map(o=>typeof o)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:n}}function I(){return{not:{}}}function w(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var d={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function q(e,t){if(t.target==="openApi3")return z(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(n=>n._def.typeName in d&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((a,o)=>{let p=d[o._def.typeName];return p&&!a.includes(p)?[...a,p]:a},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((a,o)=>{let p=typeof o._def.value;switch(p){case"string":case"number":case"boolean":return[...a,p];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(n.length===r.length){let a=n.filter((o,p,c)=>c.indexOf(o)===p);return{type:a.length>1?a:a[0],enum:r.reduce((o,p)=>o.includes(p._def.value)?o:[...o,p._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,a)=>[...n,...a._def.values.filter(o=>!n.includes(o))],[])};return z(e,t)}var z=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((n,a)=>i(n._def,{...t,currentPath:[...t.currentPath,"anyOf",`${a}`]})).filter(n=>!!n&&(!t.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function R(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:d[e.innerType._def.typeName],nullable:!0}:{type:[d[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){let n=i(e.innerType._def,{...t,currentPath:[...t.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let r=i(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function U(e,t){let r={type:"number"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case"int":r.type="integer",x(r,"type",n.message,t);break;case"min":t.target==="jsonSchema7"?n.inclusive?u(r,"minimum",n.value,n.message,t):u(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=!0),u(r,"minimum",n.value,n.message,t));break;case"max":t.target==="jsonSchema7"?n.inclusive?u(r,"maximum",n.value,n.message,t):u(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=!0),u(r,"maximum",n.value,n.message,t));break;case"multipleOf":u(r,"multipleOf",n.value,n.message,t);break}return r}function Qe(e,t){Object.keys(e.shape()).reduce((n,a)=>{let o=e.shape()[a],p=o.isOptional();p||(o={...o._def.innerSchema});let c=i(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return c!==void 0&&(n.properties[a]=c,p||(n.required||(n.required=[]),n.required.push(a))),n},{type:"object",properties:{},additionalProperties:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":i(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0});let r={type:"object",...Object.entries(e.shape()).reduce((n,[a,o])=>{if(o===void 0||o._def===void 0)return n;let p=i(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return p===void 0?n:{properties:{...n.properties,[a]:p},required:o.isOptional()?n.required:[...n.required,a]}},{properties:{},required:[]}),additionalProperties:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":i(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0};return r.required.length||delete r.required,r}function B(e,t){let r={type:"object",...Object.entries(e.shape()).reduce((n,[a,o])=>{if(o===void 0||o._def===void 0)return n;let p=i(o._def,{...t,currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]});return p===void 0?n:{properties:{...n.properties,[a]:p},required:o.isOptional()?n.required:[...n.required,a]}},{properties:{},required:[]}),additionalProperties:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":i(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0};return r.required.length||delete r.required,r}var V=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return i(e.innerType._def,t);let r=i(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}};var F=(e,t)=>{if(t.pipeStrategy==="input")return i(e.in._def,t);if(t.pipeStrategy==="output")return i(e.out._def,t);let r=i(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),n=i(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(a=>a!==void 0)}};function K(e,t){return i(e.type._def,t)}function C(e,t){let n={type:"array",uniqueItems:!0,items:i(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&u(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&u(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function J(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((r,n)=>i(r._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:i(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((r,n)=>i(r._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function W(){return{not:{}}}function H(){return{}}var X=(e,t)=>i(e.innerType._def,t);function i(e,t,r=!1){let n=t.seen.get(e);if(n&&!r){let p=ae(n,t);if(p!==void 0)return p}let a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);let o=ie(e,e.typeName,t);return o&&se(e,t,o),a.jsonSchema=o,o}var ae=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:oe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,n)=>t.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},oe=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},ie=(e,t,r)=>{switch(t){case s.ZodString:return y(e,r);case s.ZodNumber:return U(e,r);case s.ZodObject:return B(e,r);case s.ZodBigInt:return k(e,r);case s.ZodBoolean:return Z();case s.ZodDate:return j(e,r);case s.ZodUndefined:return W();case s.ZodNull:return w(r);case s.ZodArray:return _(e,r);case s.ZodUnion:case s.ZodDiscriminatedUnion:return q(e,r);case s.ZodIntersection:return N(e,r);case s.ZodTuple:return J(e,r);case s.ZodRecord:return h(e,r);case s.ZodLiteral:return L(e,r);case s.ZodEnum:return T(e);case s.ZodNativeEnum:return E(e);case s.ZodNullable:return R(e,r);case s.ZodOptional:return V(e,r);case s.ZodMap:return $(e,r);case s.ZodSet:return C(e,r);case s.ZodLazy:return i(e.getter()._def,r);case s.ZodPromise:return K(e,r);case s.ZodNaN:case s.ZodNever:return I();case s.ZodEffects:return A(e,r);case s.ZodAny:return D();case s.ZodUnknown:return H();case s.ZodDefault:return M(e,r);case s.ZodBranded:return O(e,r);case s.ZodReadonly:return X(e,r);case s.ZodCatch:return S(e,r);case s.ZodPipeline:return F(e,r);case s.ZodFunction:case s.ZodVoid:case s.ZodSymbol:return;default:return(n=>{})(t)}},se=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r);var G=e=>{let t=v(e),r=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([n,a])=>[a._def,{def:a._def,path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]))}};var Q=(e,t)=>{let r=G(t),n=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((c,[g,Y])=>({...c,[g]:i(Y._def,{...r,currentPath:[...r.basePath,r.definitionPath,g]},!0)??{}}),{}):void 0,a=typeof t=="string"?t:t?.name,o=i(e._def,a===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,a]},!1)??{},p=a===void 0?n?{...o,[r.definitionPath]:n}:o:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,a].join("/"),[r.definitionPath]:{...n,[a]:o}};return r.target==="jsonSchema7"?p.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(p.$schema="https://json-schema.org/draft/2019-09/schema#"),p};var Yt=Q;export{x as addErrorMessage,Yt as default,b as defaultOptions,v as getDefaultOptions,G as getRefs,D as parseAnyDef,_ as parseArrayDef,k as parseBigintDef,Z as parseBooleanDef,O as parseBrandedDef,S as parseCatchDef,j as parseDateDef,i as parseDef,M as parseDefaultDef,A as parseEffectsDef,T as parseEnumDef,N as parseIntersectionDef,L as parseLiteralDef,$ as parseMapDef,E as parseNativeEnumDef,I as parseNeverDef,w as parseNullDef,R as parseNullableDef,U as parseNumberDef,B as parseObjectDef,Qe as parseObjectDefX,V as parseOptionalDef,F as parsePipelineDef,K as parsePromiseDef,X as parseReadonlyDef,h as parseRecordDef,C as parseSetDef,y as parseStringDef,J as parseTupleDef,W as parseUndefinedDef,q as parseUnionDef,H as parseUnknownDef,d as primitiveMappings,u as setResponseValueAndErrors,f as zodPatterns,Q as zodToJsonSchema};
//# sourceMappingURL=zod-to-json-schema.mjs.map